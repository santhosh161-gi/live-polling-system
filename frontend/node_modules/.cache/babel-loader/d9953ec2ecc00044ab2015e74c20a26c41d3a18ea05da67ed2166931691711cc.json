{"ast":null,"code":"import React,{useState,useEffect}from'react';import socket from'../socket';import{nanoid}from'nanoid';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Student(){const[poll,setPoll]=useState(null);const[studentName,setStudentName]=useState('');const[studentId,setStudentId]=useState(localStorage.getItem('studentId')||'');const[answered,setAnswered]=useState(false);useEffect(()=>{// ensure studentId\nif(!studentId){const id=nanoid(10);localStorage.setItem('studentId',id);setStudentId(id);}socket.on('pollStarted',p=>{setPoll(p);setAnswered(false);});socket.on('pollUpdated',p=>setPoll(p));socket.on('pollEnded',()=>setPoll(null));socket.on('alreadyAnswered',()=>setAnswered(true));// initial active poll fetch (optional)\nfetch('/api/polls/active').then(r=>r.json()).then(p=>{if(p)setPoll(p);}).catch(()=>{});return()=>{socket.off('pollStarted');socket.off('pollUpdated');socket.off('pollEnded');};},[studentId]);const submit=optionId=>{if(!studentName.trim()){const name=prompt('Please enter your name (display)');if(!name)return;setStudentName(name);}socket.emit('submitAnswer',{pollId:poll._id,optionId,studentId});setAnswered(true);};if(!poll)return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"No active poll\"})});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:poll.question}),answered?/*#__PURE__*/_jsx(\"ul\",{children:poll.options.map(o=>/*#__PURE__*/_jsxs(\"li\",{children:[o.text,\" \\u2014 \",o.votes]},o.id))}):poll.options.map(o=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>submit(o.id),children:o.text},o.id))]});}","map":{"version":3,"names":["React","useState","useEffect","socket","nanoid","jsx","_jsx","jsxs","_jsxs","Student","poll","setPoll","studentName","setStudentName","studentId","setStudentId","localStorage","getItem","answered","setAnswered","id","setItem","on","p","fetch","then","r","json","catch","off","submit","optionId","trim","name","prompt","emit","pollId","_id","children","question","options","map","o","text","votes","onClick"],"sources":["C:/Users/santhosh/Downloads/live-polling/frontend/src/pages/Student.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport socket from '../socket';\r\nimport { nanoid } from 'nanoid';\r\n\r\nexport default function Student() {\r\n  const [poll, setPoll] = useState(null);\r\n  const [studentName, setStudentName] = useState('');\r\n  const [studentId, setStudentId] = useState(localStorage.getItem('studentId') || '');\r\n  const [answered, setAnswered] = useState(false);\r\n\r\n  useEffect(()=>{\r\n    // ensure studentId\r\n    if (!studentId) {\r\n      const id = nanoid(10);\r\n      localStorage.setItem('studentId', id);\r\n      setStudentId(id);\r\n    }\r\n\r\n    socket.on('pollStarted', p => { setPoll(p); setAnswered(false); });\r\n    socket.on('pollUpdated', p => setPoll(p));\r\n    socket.on('pollEnded', ()=> setPoll(null));\r\n    socket.on('alreadyAnswered', ()=> setAnswered(true));\r\n\r\n    // initial active poll fetch (optional)\r\n    fetch('/api/polls/active').then(r=>r.json()).then(p=>{\r\n      if (p) setPoll(p);\r\n    }).catch(()=>{});\r\n    return ()=> { socket.off('pollStarted'); socket.off('pollUpdated'); socket.off('pollEnded'); }\r\n  },[studentId]);\r\n\r\n  const submit = (optionId) => {\r\n    if (!studentName.trim()) {\r\n      const name = prompt('Please enter your name (display)');\r\n      if (!name) return;\r\n      setStudentName(name);\r\n    }\r\n    socket.emit('submitAnswer', { pollId: poll._id, optionId, studentId });\r\n    setAnswered(true);\r\n  };\r\n\r\n  if (!poll) return <div><h2>No active poll</h2></div>;\r\n\r\n  return (\r\n    <div>\r\n      <h2>{poll.question}</h2>\r\n      {answered ? (\r\n        <ul>\r\n          {poll.options.map(o => <li key={o.id}>{o.text} â€” {o.votes}</li>)}\r\n        </ul>\r\n      ) : (\r\n        poll.options.map(o =>\r\n          <button key={o.id} onClick={()=>submit(o.id)}>{o.text}</button>\r\n        )\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}